<!-- index.html -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Eaqar - بيع العقارات</title>
  <link rel="icon" href="logo.png"/>
  <meta name="color-scheme" content="light only"/>

  <style>
    /* ===== لوحة ألوان ===== */
    :root{
      --brand:#1f8bcb;          /* الأزرق الرئيسي */
      --brand-dark:#144b81;     /* الأزرق الغامق */
      --accent:#0fbf9f;         /* لون مساعد متناغم */
      --surface:#ffffff;
      --surface-2:#f4f7fb;
      --text:#0f172a;
      --muted:#667085;
      --shadow:0 10px 30px rgba(0,0,0,.15);

      /* نافذة التفاصيل */
      --overlay: rgba(2, 6, 23, .52);
      --ring: rgba(31,139,203,.25);
    }

    *{box-sizing:border-box}
    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      font-family:"Tajawal",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
      color:var(--text);
      color: #000000;
      background:var(--surface-2);
    }

    /* ===== البانر بالفيديو ===== */
    .hero{
      position:relative;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      color:#fff;
      overflow:hidden;
      isolation:isolate;
    }
    .bg-video{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover;
      z-index:-2;
    }
    .overlay{
      position:absolute; inset:0;
      background:
        radial-gradient(1200px 600px at 80% -10%, rgba(31,139,203,.55), transparent 60%),
        linear-gradient(180deg, rgba(20,75,129,.82), rgba(20,75,129,.62) 35%, rgba(31,139,203,.45) 100%);
      z-index:-1;
    }
    .hero::after{
      content:"";
      position:absolute; left:0; right:0; bottom:-1px; height:120px;
      background:linear-gradient(180deg, rgba(0,0,0,0) 0%, var(--surface-2) 85%);
      pointer-events:none;
      z-index:0;
    }

    .hero-content{
      z-index:1;
      padding:24px;
      animation: rise 1.1s ease both;
      max-width: 900px;
      width: calc(100% - 32px);
    }
    @keyframes rise{ from{opacity:0; transform:translateY(18px)} to{opacity:1; transform:translateY(0)} }

    .brand-badge{
      display:inline-flex; align-items:center; gap:10px;
      background: rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.22);
      padding:8px 14px; border-radius:999px; margin-bottom:16px;
      box-shadow:0 4px 14px rgba(0,0,0,.15);
    }
    .brand-badge img{
      width:28px; height:28px; object-fit:contain; border-radius:6px; background:#fff;
    }
    .brand-badge span{font-weight:700; letter-spacing:.3px}

    .hero h1{
      margin:8px 0 8px;
      font-size: clamp(1.8rem, 4vw + .5rem, 3.1rem);
      line-height:1.2;
    }
    .hero .mark{
      color:var(--brand);
      text-shadow:0 6px 20px rgba(31,139,203,.45);
    }
    .hero p{
      margin:0 auto 22px;
      font-size: clamp(1rem, 1.5vw + .5rem, 1.2rem);
      color:#e8f2fb;
      max-width:720px;
    }

    .cta{
      display:inline-flex; align-items:center; gap:10px;
      padding:14px 22px;
      border:none; border-radius:999px;
      font-size:1rem; font-weight:800;
      cursor:pointer; color:#062a46;
      background: linear-gradient(135deg, var(--brand), #58b6e3);
      box-shadow: 0 10px 24px rgba(31,139,203,.35);
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
      text-decoration:none;
    }
    .cta:hover{ transform: translateY(-2px); box-shadow: 0 16px 32px rgba(31,139,203,.45); filter:brightness(1.03); }
    .cta:active{ transform: translateY(0) scale(.98); }

    /* ===== مربع التفاصيل (Stats) ===== */
    .stats{
      position:absolute; bottom:80px; left:50%; transform:translateX(-50%);
      display:flex; align-items:center; gap:18px;
      padding:12px 18px;
      border-radius:18px;
      background: rgba(255,255,255,.92);
      -webkit-backdrop-filter: blur(6px);
      backdrop-filter: blur(6px);
      border:1px solid rgba(20,75,129,.25);
      box-shadow: 0 10px 26px rgba(0,0,0,.18);
      color:#123354; font-weight:800;
    }
    .stats .item{
      display:flex; align-items:center; gap:10px;
      white-space:nowrap;
    }
    .stats .item b{ font-size:1.05rem; }
    .stats .sep{ width:1px; height:20px; background:rgba(20,75,129,.25); }
    .stats .dot{ width:8px; height:8px; border-radius:50%; background:var(--accent); }
    .stats .dot.secondary{ background:var(--brand) }

    @media (max-width: 560px){
      .stats{
        width: calc(100% - 28px);
        padding:12px;
        gap:12px;
        display:grid;
        grid-template-columns: 1fr 1fr;
        row-gap:10px;
      }
      .stats .item{
        justify-content:center;
        background: rgba(255,255,255,.96);
        border:1px solid rgba(20,75,129,.18);
        border-radius:12px;
        padding:8px 10px;
      }
      .stats .sep{ display:none; }
    }

    /* ===== قسم العقارات ===== */
    .properties{
      padding: 64px 20px 80px;
      background: var(--surface-2);
      text-align:center;
    }
    .section-title{
      font-size:clamp(1.4rem, 2vw + .5rem, 2.2rem);
      margin:0 0 8px;
      color:var(--brand-dark);
    }
    .section-sub{
      margin:0 auto 36px; color:var(--muted); max-width:680px;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap:22px;
      max-width: 1200px; margin:0 auto;
    }
    .card{
      background:var(--surface);
      border-radius:16px;
      overflow:hidden;
      box-shadow: var(--shadow);
      transition: transform .2s ease, box-shadow .2s ease;
      text-align:right;
      border:1px solid rgba(20,75,129,.08);
    }
    .card:hover{ transform: translateY(-6px); box-shadow: 0 16px 40px rgba(0,0,0,.18); }
    .card img{ width:100%; height:200px; object-fit:cover; display:block; }
    .card .content{ padding:14px 16px 16px; }
    .badge{
      display:inline-block;
      background: rgba(31,139,203,.08);
      color: var(--brand-dark);
      border: 1px solid rgba(31,139,203,.22);
      padding:4px 10px; border-radius:999px; font-size:.78rem; margin-bottom:8px;
    }
    .card h3{ margin:6px 0 6px; font-size:1.1rem; color:#0f172a }
    .price{ color: var(--accent); font-weight:900; }
    .actions{ display:flex; gap:10px; margin-top:10px }
    .btn{
      flex:1; text-align:center; padding:10px 12px; border-radius:10px;text-decoration: none;
      border:1px solid rgba(20,75,129,.18); background:#fff; cursor:pointer; font-weight:800;
    }
    .btn--primary{
      background: var(--brand-dark);
      color:#fff; border-color: transparent;
    }
    .btn--primary:hover{ filter:brightness(1.05) }

    /* ===== نافذة التفاصيل (Pop-up) ===== */
    .modal{
      position:fixed; inset:0; display:none;
      align-items:center; justify-content:center;
      background: var(--overlay);
      z-index: 2000;
    }
    .modal.show{ display:flex; }
    .modal-card{
      width:min(900px, calc(100% - 24px));
      background:#fff; border-radius:16px; box-shadow: var(--shadow);
      overflow:hidden; animation: pop .22s ease both;
    }
    @keyframes pop{from{transform:translateY(10px);opacity:0}to{transform:none;opacity:1}}
    .modal-head{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px; border-bottom:1px solid #edf2f7; background: linear-gradient(180deg,#f7fbff,#ffffff);
    }
    .modal-title{ margin:0; font-weight:900; color:var(--brand-dark) }
    .close-btn{
      border:none; background:#f1f5f9; color:#0f172a; font-weight:800; cursor:pointer;
      border-radius:8px; padding:6px 10px;
    }
    .close-btn:hover{ background:#e2e8f0 }
    .modal-body{ display:grid; grid-template-columns: 1fr; gap:14px; padding:12px 16px 16px; }
    @media(min-width:860px){ .modal-body{ grid-template-columns: .9fr 1.1fr; } }

    .details-list{
      border:1px solid #e6eef7; border-radius:12px; padding:12px; background:#fbfdff;
      line-height:1.9;
    }
    .details-list b{ color:#0f172a }
    .map-box{
      border:1px solid #e6eef7; border-radius:12px; overflow:hidden; background:#eef5fb;
      min-height:300px;
    }
    .map-box iframe{ width:100%; height:100%; display:block; border:0; }

    .meta{
      display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px; margin-top:8px;
    }
    .meta .chip{
      background:#f1f7fc; border:1px solid #d7e7f7; color:#0f2f4a; border-radius:10px;
      padding:8px 10px; font-weight:800; text-align:center;
    }

    /* ===== مساعدات ===== */
    .sr-only{position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0}
  </style>
</head>
<body>

  <!-- الهيدر (يتم تضمينه) -->
  <div w3-include-html="header.html"></div>

  <!-- البانر -->
  <section class="hero" id="hero">
    <video class="bg-video" autoplay muted loop playsinline poster="logo.png">
      <source src="vid.mp4" type="video/mp4"/>
      متصفحك لا يدعم تشغيل الفيديو.
    </video>
    <div class="overlay" aria-hidden="true"></div>

    <div class="hero-content">
      <div class="brand-badge">
        <img src="logo.png" alt="شعار Eaqar"/>
        <span>منصة عقارية موثوقة</span>
      </div>

      <h1>اكتشف <span class="mark">بيت أحلامك</span> مع Eaqar</h1>
      <p>نقدّم لك مجموعة مختارة من الفلل والشقق والأراضي بأفضل الأسعار وخيارات تمويل تناسبك.</p>

      <a class="cta" href="#properties">
        <span class="sr-only">الانتقال إلى قسم العقارات المميزة</span>
        ابدأ البحث الآن
      </a>
    </div>

    <div class="stats" aria-label="معلومات سريعة">
      <div class="item">
        <span class="dot secondary"></span>
        <b>+250</b>
        <span>عقار مميز</span>
      </div>
      <div class="sep"></div>
      <div class="item">
        <span class="dot"></span>
        <b>38</b>
        <span>تم البيع هذا الشهر</span>
      </div>
    </div>
  </section>

  <!-- قائمة العقارات -->
  <section class="properties" id="properties">
    <h2 class="section-title">عقارات مميزة</h2>
    <p class="section-sub">اختر من بين أفضل العقارات المعروضة لدينا بمواقع استثنائية وتشطيبات عالية الجودة.</p>

    <div class="grid">
      <!-- فيلا -->
      <article class="card">
        <img src="E2.jpg" alt="فيلا فاخرة بواجهة حديثة">
        <div class="content">
          <span class="badge">فيلا</span>
          <h3>فيلا فاخرة – حي الربيع</h3>
          <div class="price">2,500,000 ريال</div>
          <div class="actions">
            <button
              class="btn btn-details"
              data-type="فيلا"
              data-title="فيلا فاخرة – حي الربيع"
              data-area="480 م²"
              data-location="الرياض - حي الربيع"
              data-bed="5"
              data-bath="6"
              data-lat="24.774265"
              data-lng="46.738586"
              data-notes="مدخلان + مجلس خارجي + موقفان سيارات">
              تفاصيل
            </button>
            <a class="btn btn--primary"
               href="#"
               data-type="فيلا"
               data-title="فيلا فاخرة – حي الربيع"
               onclick="return openWhatsApp(this)"
               aria-label="حجز زيارة لفيلا فاخرة – حي الربيع عبر واتساب">احجز زيارة</a>
          </div>
        </div>
      </article>

      <!-- شقة -->
      <article class="card">
        <img src="E1.jpeg" alt="شقة راقية حديثة">
        <div class="content">
          <span class="badge">شقة</span>
          <h3>شقة راقية – وسط المدينة</h3>
          <div class="price">750,000 ريال</div>
          <div class="actions">
            <button
              class="btn btn-details"
              data-type="شقة"
              data-title="شقة راقية – وسط المدينة"
              data-area="140 م²"
              data-location="الرياض - مركز المدينة"
              data-floor="الطابق السابع"
              data-bed="3"
              data-bath="3"
              data-lat="24.713551"
              data-lng="46.675297"
              data-notes="موقف سفلي خاص + قرب المترو 300م">
              تفاصيل
            </button>
            <a class="btn btn--primary"
               href="#"
               data-type="شقة"
               data-title="شقة راقية – وسط المدينة"
               onclick="return openWhatsApp(this)"
               aria-label="حجز زيارة لشقة راقية – وسط المدينة عبر واتساب">احجز زيارة</a>
          </div>
        </div>
      </article>

      <!-- أرض -->
      <article class="card">
        <img src="E3.jpg" alt="أرض استثمارية">
        <div class="content">
          <span class="badge">أرض</span>
          <h3>أرض استثمارية – مخطط الحيلة الغربي</h3>
          <div class="price">1,200,000 ريال</div>
          <div class="actions">
            <button
              class="btn btn-details"
              data-type="أرض"
              data-title="أرض استثمارية – مخطط الحيلة الغربي"
              data-area="600 م²"
              data-location="مخطط الحيلة الغربي"
              data-bounds="شمالًا شارع 20م، جنوبًا جار، شرقًا ممر 10م، غربًا شارع 15م"
              data-lat="18.216389"
              data-lng="42.505278"
              data-notes="مناسبة لمشروع شقق فندقية">
              تفاصيل
            </button>
            <a class="btn btn--primary"
               href="#"
               data-type="أرض استثمارية"
               data-title="أرض استثمارية – مخطط الحيلة الغربي"
               onclick="return openWhatsApp(this)"
               aria-label="حجز زيارة لأرض استثمارية – مخطط الحيلة الغربي عبر واتساب">احجز زيارة</a>
          </div>
        </div>
      </article>
    </div>
  </section>

  <!-- نافذة التفاصيل (عامّة لكل البطاقات) -->
  <div class="modal" id="detailsModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-head">
        <h3 class="modal-title" id="modalTitle">تفاصيل</h3>
        <button class="close-btn" id="closeModal" aria-label="إغلاق النافذة">إغلاق ✕</button>
      </div>

      <div class="modal-body">
        <div>
          <div class="details-list" id="detailsList">
            <!-- يتم حقنه ديناميكياً -->
          </div>

          <div class="meta" id="metaChips">
            <!-- شرائح سريعة (غرف/حمامات/المساحة/الطابق) -->
          </div>
        </div>

        <div class="map-box">
          <iframe id="mapFrame" title="خريطة الموقع" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
      </div>
    </div>
  </div>

  <!-- الفوتر (يتم تضمينه) -->
  <div w3-include-html="footer.html"></div>

  <script>
    /* تضمين الهيدر والفوتر */
    function includeHTML(){
      const nodes=document.querySelectorAll("[w3-include-html]");
      nodes.forEach(async (el)=>{
        const file=el.getAttribute("w3-include-html");
        if(!file) return;
        try{
          const r=await fetch(file);
          el.innerHTML=await r.text();
          el.removeAttribute("w3-include-html");
          includeHTML(); // للتضمينات المتداخلة
        }catch(e){ console.warn("Include failed:", file, e); }
      });
    }
    includeHTML();

    /* ضمان تشغيل الفيديو */
    (function ensureVideo(){
      const v=document.querySelector(".bg-video");
      if(!v) return;
      const tryPlay=()=> v.play().catch(()=>{});
      if(v.readyState>=2){ tryPlay(); }
      v.addEventListener("canplay", tryPlay, {once:true});
      setTimeout(()=>{ if(v.paused){ document.getElementById("hero").classList.add("no-video"); }}, 1500);
    })();

    /* ===== واتساب برسالة مخصّصة ===== */
    const WHATSAPP_NUMBER = "966501424219";
    function openWhatsApp(el){
      const type  = el.getAttribute('data-type')  || 'عقار';
      const title = el.getAttribute('data-title') || '';
      const msg = `أرغب في حجز زيارة إلى ${title} - نوع الحجز: ${type}`;
      const encoded = encodeURIComponent(msg);
      const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encoded}`;
      window.open(url, "_blank", "noopener");
      return false;
    }

    /* ===== نافذة التفاصيل ===== */
    const modal      = document.getElementById('detailsModal');
    const closeModal = document.getElementById('closeModal');
    const titleEl    = document.getElementById('modalTitle');
    const detailsEl  = document.getElementById('detailsList');
    const chipsEl    = document.getElementById('metaChips');
    const mapFrame   = document.getElementById('mapFrame');

    // فتح النافذة عند الضغط على أي زر تفاصيل
    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('.btn-details');
      if(!btn) return;

      const type     = btn.getAttribute('data-type')     || '';
      const title    = btn.getAttribute('data-title')    || '';
      const area     = btn.getAttribute('data-area')     || '';
      const location = btn.getAttribute('data-location') || '';
      const floor    = btn.getAttribute('data-floor')    || '';
      const bed      = btn.getAttribute('data-bed')      || '';
      const bath     = btn.getAttribute('data-bath')     || '';
      const bounds   = btn.getAttribute('data-bounds')   || '';
      const lat      = btn.getAttribute('data-lat');
      const lng      = btn.getAttribute('data-lng');
      const notes    = btn.getAttribute('data-notes')    || '';

      // عنوان
      titleEl.textContent = `${title} — تفاصيل ${type}`;

      // تفاصيل نصية
      const rows = [];
      if(area)     rows.push(`<div><b>المساحة:</b> ${escapeHTML(area)}</div>`);
      if(location) rows.push(`<div><b>الموقع:</b> ${escapeHTML(location)}</div>`);

      if(type === 'شقة' && floor){
        rows.push(`<div><b>الطابق:</b> ${escapeHTML(floor)}</div>`);
      }
      if(type !== 'أرض' && (bed || bath)){
        if(bed)  rows.push(`<div><b>عدد الغرف:</b> ${escapeHTML(bed)}</div>`);
        if(bath) rows.push(`<div><b>الحمامات:</b> ${escapeHTML(bath)}</div>`);
      }
      if(type === 'أرض' && bounds){
        rows.push(`<div><b>الحدود والأطوال:</b> ${escapeHTML(bounds)}</div>`);
      }
      if(notes){
        rows.push(`<div><b>ملاحظات:</b> ${escapeHTML(notes)}</div>`);
      }
      detailsEl.innerHTML = rows.join('');

      // شرائح مختصرة
      chipsEl.innerHTML = '';
      if(area)    chipsEl.appendChild(makeChip(`المساحة: ${area}`));
      if(bed)     chipsEl.appendChild(makeChip(`غرف: ${bed}`));
      if(bath)    chipsEl.appendChild(makeChip(`حمامات: ${bath}`));
      if(floor)   chipsEl.appendChild(makeChip(`${floor}`));

      // خريطة
      if(lat && lng){
        const src = `https://www.google.com/maps?q=${encodeURIComponent(lat)},${encodeURIComponent(lng)}&hl=ar&z=15&output=embed`;
        mapFrame.src = src;
      }else{
        mapFrame.removeAttribute('src');
      }

      openModal();
    });

    function makeChip(text){
      const d = document.createElement('div');
      d.className = 'chip';
      d.textContent = text;
      return d;
    }
    function escapeHTML(v){
      return (v??'').toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
    }

    function openModal(){
      modal.classList.add('show');
      modal.setAttribute('aria-hidden','false');
      // قفل التمرير بالخلفية
      document.documentElement.style.overflow='hidden';
      closeModal.focus();
    }
    function hideModal(){
      modal.classList.remove('show');
      modal.setAttribute('aria-hidden','true');
      document.documentElement.style.overflow='';
      // تنظيف الخريطة لتقليل الاستهلاك
      mapFrame.removeAttribute('src');
    }

    closeModal.addEventListener('click', hideModal);
    modal.addEventListener('click', (e)=>{ if(e.target===modal) hideModal(); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && modal.classList.contains('show')) hideModal(); });
  </script>

  <style>
    /* خلفية بديلة عند تعذر الفيديو */
    .no-video .overlay{
      background: linear-gradient(180deg, rgba(20,75,129,.85), rgba(20,75,129,.65) 40%, rgba(31,139,203,.55));
    }
  </style>
</body>
</html>
